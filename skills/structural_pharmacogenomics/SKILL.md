---
name: structural_pharmacogenomics
description: "Structural Pharmacogenomics - Link structure to pharmacogenomics: variant effect, protein structure change, drug binding, and clinical data. Use this skill for pharmacogenomics tasks involving get vep hgvs pred protein structure esmfold boltz binding affinity get pharmacogenomics info by drug name. Combines 4 tools from 3 SCP server(s)."
---

# Structural Pharmacogenomics

**Discipline**: Pharmacogenomics | **Tools Used**: 4 | **Servers**: 3

## Description

Link structure to pharmacogenomics: variant effect, protein structure change, drug binding, and clinical data.

## Tools Used

- **`get_vep_hgvs`** from `ensembl-server` (streamable-http) - `https://scp.intern-ai.org.cn/api/v1/mcp/12/Origene-Ensembl`
- **`pred_protein_structure_esmfold`** from `server-3` (streamable-http) - `https://scp.intern-ai.org.cn/api/v1/mcp/3/DrugSDA-Model`
- **`boltz_binding_affinity`** from `server-3` (streamable-http) - `https://scp.intern-ai.org.cn/api/v1/mcp/3/DrugSDA-Model`
- **`get_pharmacogenomics_info_by_drug_name`** from `fda-drug-server` (streamable-http) - `https://scp.intern-ai.org.cn/api/v1/mcp/14/Origene-FDADrug`

## Workflow

1. Predict variant effect
2. Predict mutant structure
3. Compare binding affinity
4. Get pharmacogenomics data

## Test Case

### Input
```json
{
    "variant": "ENSP00000227163.5:p.Pro227Ser",
    "sequence": "MKTIIALSYIFCLVFA",
    "drug": "warfarin"
}
```

### Expected Steps
1. Predict variant effect
2. Predict mutant structure
3. Compare binding affinity
4. Get pharmacogenomics data

## Usage Example

> **Note:** Replace `<YOUR_SCP_HUB_API_KEY>` with your own SCP Hub API Key. You can obtain one from the [SCP Platform](https://scp.intern-ai.org.cn).

```python
import asyncio
import json
from mcp import ClientSession
from mcp.client.streamable_http import streamablehttp_client
from mcp.client.sse import sse_client

SERVERS = {
    "ensembl-server": "https://scp.intern-ai.org.cn/api/v1/mcp/12/Origene-Ensembl",
    "server-3": "https://scp.intern-ai.org.cn/api/v1/mcp/3/DrugSDA-Model",
    "fda-drug-server": "https://scp.intern-ai.org.cn/api/v1/mcp/14/Origene-FDADrug"
}

async def connect(url, transport_type):
    transport = streamablehttp_client(url=url, headers={"SCP-HUB-API-KEY": "<YOUR_SCP_HUB_API_KEY>"})
    read, write, _ = await transport.__aenter__()
    ctx = ClientSession(read, write)
    session = await ctx.__aenter__()
    await session.initialize()
    return session, ctx, transport

def parse(result):
    try:
        if hasattr(result, 'content') and result.content:
            c = result.content[0]
            if hasattr(c, 'text'):
                try: return json.loads(c.text)
                except: return c.text
        return str(result)
    except: return str(result)

async def main():
    # Connect to required servers
    sessions = {}
    sessions["ensembl-server"], _, _ = await connect("https://scp.intern-ai.org.cn/api/v1/mcp/12/Origene-Ensembl", "streamable-http")
    sessions["server-3"], _, _ = await connect("https://scp.intern-ai.org.cn/api/v1/mcp/3/DrugSDA-Model", "streamable-http")
    sessions["fda-drug-server"], _, _ = await connect("https://scp.intern-ai.org.cn/api/v1/mcp/14/Origene-FDADrug", "streamable-http")

    # Execute workflow steps
    # Step 1: Predict variant effect
    result_1 = await sessions["ensembl-server"].call_tool("get_vep_hgvs", arguments={})
    data_1 = parse(result_1)
    print(f"Step 1 result: {json.dumps(data_1, indent=2, ensure_ascii=False)[:500]}")

    # Step 2: Predict mutant structure
    result_2 = await sessions["server-3"].call_tool("pred_protein_structure_esmfold", arguments={})
    data_2 = parse(result_2)
    print(f"Step 2 result: {json.dumps(data_2, indent=2, ensure_ascii=False)[:500]}")

    # Step 3: Compare binding affinity
    result_3 = await sessions["server-3"].call_tool("boltz_binding_affinity", arguments={})
    data_3 = parse(result_3)
    print(f"Step 3 result: {json.dumps(data_3, indent=2, ensure_ascii=False)[:500]}")

    # Step 4: Get pharmacogenomics data
    result_4 = await sessions["fda-drug-server"].call_tool("get_pharmacogenomics_info_by_drug_name", arguments={})
    data_4 = parse(result_4)
    print(f"Step 4 result: {json.dumps(data_4, indent=2, ensure_ascii=False)[:500]}")

    # Cleanup
    print("Workflow complete!")

if __name__ == "__main__":
    asyncio.run(main())
```
